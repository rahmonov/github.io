<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
          <title> How to write clean functions - Jahongir Rahmonov </title>

        <link rel="stylesheet" href="/static/css/main.css" />
        <link rel="stylesheet" href="/static/css/pygment.css" />
        <link rel="stylesheet" href="/static/css/font-awesome.min.css" />
        <link href="//fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="/static/vendor/lightbox2/css/lightbox.min.css">
        <link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Jahongir Rahmonov's personal blog" />
        <meta name="author" content="Jahongir Rahmonov" />
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<meta property="og:title" content="How to write clean functions - Jahongir Rahmonov">
<meta property="og:type" content="website">
<meta property="og:image" content="/static/images/programming.jpg">
<meta property="og:url" content="http://rahmonov.github.io/posts/how-to-write-clean-functions/">
<meta property="og:description" content="<p>Key takeaways from the chapter Functions of the book Clean Code by Robert C. Martin</p>">

        <link href="http://rahmonov.github.io/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Jahongir Rahmonov Full Atom Feed" />
        <link href="http://rahmonov.github.io/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Jahongir Rahmonov Full RSS Feed" />
        <link href="http://rahmonov.github.io/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="Jahongir Rahmonov Categories Atom Feed" />



    <meta name="tags" content="clean" />
    <meta name="tags" content="code" />
    <meta name="tags" content="functions" />
    <meta name="tags" content="robert" />
    <meta name="tags" content="martin" />

</head>

<body id="index" class="home">
    <div class="container">

        <button class="nav js-mobile">
            <i class="fa fa-bars"></i>
        </button>

        <div class="side">
            <div class="logo">
                <a href="/"><img src="/static/images/me.jpg" class="jahon" alt="Jahongir Rahmonov"/></a>
            </div>

            <h2>Jahongir Rahmonov</h2>

            <div class="paragraphs">
<p>
    I'm a Software Developer at <a href="http://mysuperdispatch.com/">Super Dispatch (TechStars '16)</a>.
    Avid reader.
    <a href="http://wiut.uz/">WIUT</a> graduate.
    Blogger and an amateur speaker
</p>
<p>
    I write about Python, Django, AngularJS and sometimes something non-technical.
</p>
<p>
    Welcome to my corner <i class="em em-snake"></i>
</p>            </div>

            <form method="get" action="https://www.google.com/search">
                <input name="sitesearch" value="rahmonov.me" type="hidden">
                <input type="text" id="search-query" class="field field-text" required="required" name="q" placeholder="Search..." autocomplete="off">
                <input type="image" src="/static/images/search-icon.png" width="20" height="20" class="search-icon" title="Search via Google" alt="Search via Google">
            </form>

            <ul class="menu">
                <li><a href="/">Home</a></li>
                <li><a href="/pages/posts.html">Posts</a></li>
                <li><a href="/pages/about.html">About</a></li>
                <li><a href="/pages/about.html#contact">Contact</a></li>
                <li><a href="/feeds/atom.xml" target="_blank">RSS <i class="fa fa-rss"></i></a></li>
            </ul>

            <p class="profiles">
                <a title="GitHub" href="https://github.com/rahmonov" target="_blank"><i class="fa fa-github-square"></i></a>
                <a title="Twitter" href="https://twitter.com/the_rahmonov" target="_blank"><i class="fa fa-twitter-square"></i></a>
                <a title="Facebook" href="https://www.facebook.com/rahmonovj" target="_blank"><i class="fa fa-facebook-official"></i></a>
                <a title="Bitbucket" href="https://bitbucket.org/Jahongir/" target="_blank"><i class="fa fa-bitbucket-square"></i></a>
                <a title="LinkedIn" href="https://www.linkedin.com/in/jahongirrahmonov" target="_blank"><i class="fa fa-linkedin-square"></i></a>
            </p>
        </div>

        <div class="wrap">
            <div class="content">

  <h4>Wed 15 June 2016</h4>

  <h1>How to write clean functions</h1>

  <div class="entry-content">
    <p>The following is heavily influenced (99%) by one of the must-read books for any developer: <a href="https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882">Clean Code: A Handbook of Agile Software Craftsmanship</a></p>
<h2>Clean Code</h2>
<div class="highlight"><pre><span></span>Always code as if the guy who ends up maintaining your code will be a violent psychopath who knows where you live.
Code for readability.
</pre></div>


<p>Damn right!!! Uncle Bob Martin even mentions of a once-successful company that went bankrupt 
because of unmaintainable codebase. Clean code is that serious.</p>
<p>Now that we know the importance of clean code, let's take a look at how to write clean functions first.</p>
<h2>Clean Functions</h2>
<p>Functions are key players in any program and it is very important to write them well.</p>
<p>Let's take a look at the following code:</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">testableHtml</span><span class="o">(</span><span class="n">PageData</span> <span class="n">pageData</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">includeSuiteSetup</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">WikiPage</span> <span class="n">wikiPage</span> <span class="o">=</span> <span class="n">pageData</span><span class="o">.</span><span class="na">getWikiPage</span><span class="o">();</span>
    <span class="n">StringBuffer</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">pageData</span><span class="o">.</span><span class="na">hasAttribute</span><span class="o">(</span><span class="s">&quot;Test&quot;</span><span class="o">))</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">includeSuiteSetup</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">WikiPage</span> <span class="n">suiteSetup</span> <span class="o">=</span>
                    <span class="n">PageCrawlerImpl</span><span class="o">.</span><span class="na">getInheritedPage</span><span class="o">(</span>
                            <span class="n">SuiteResponder</span><span class="o">.</span><span class="na">SUITE_SETUP_NAME</span><span class="o">,</span> <span class="n">wikiPage</span>
                    <span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">suiteSetup</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">WikiPagePath</span> <span class="n">pagePath</span> <span class="o">=</span>
                        <span class="n">suiteSetup</span><span class="o">.</span><span class="na">getPageCrawler</span><span class="o">().</span><span class="na">getFullPath</span><span class="o">(</span><span class="n">suiteSetup</span><span class="o">);</span>
                <span class="n">String</span> <span class="n">pagePathName</span> <span class="o">=</span> <span class="n">PathParser</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="n">pagePath</span><span class="o">);</span>
                <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;!include -setup .&quot;</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pagePathName</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="n">WikiPage</span> <span class="n">setup</span> <span class="o">=</span>
                <span class="n">PageCrawlerImpl</span><span class="o">.</span><span class="na">getInheritedPage</span><span class="o">(</span><span class="s">&quot;SetUp&quot;</span><span class="o">,</span> <span class="n">wikiPage</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">setup</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">WikiPagePath</span> <span class="n">setupPath</span> <span class="o">=</span>
                    <span class="n">wikiPage</span><span class="o">.</span><span class="na">getPageCrawler</span><span class="o">().</span><span class="na">getFullPath</span><span class="o">(</span><span class="n">setup</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">setupPathName</span> <span class="o">=</span> <span class="n">PathParser</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="n">setupPath</span><span class="o">);</span>
            <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;!include -setup .&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">setupPathName</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pageData</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">pageData</span><span class="o">.</span><span class="na">hasAttribute</span><span class="o">(</span><span class="s">&quot;Test&quot;</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">WikiPage</span> <span class="n">teardown</span> <span class="o">=</span>
                <span class="n">PageCrawlerImpl</span><span class="o">.</span><span class="na">getInheritedPage</span><span class="o">(</span><span class="s">&quot;TearDown&quot;</span><span class="o">,</span> <span class="n">wikiPage</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">teardown</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">WikiPagePath</span> <span class="n">tearDownPath</span> <span class="o">=</span>
                    <span class="n">wikiPage</span><span class="o">.</span><span class="na">getPageCrawler</span><span class="o">().</span><span class="na">getFullPath</span><span class="o">(</span><span class="n">teardown</span><span class="o">);</span>
            <span class="n">String</span> <span class="n">tearDownPathName</span> <span class="o">=</span> <span class="n">PathParser</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="n">tearDownPath</span><span class="o">);</span>
            <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;!include -teardown .&quot;</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">tearDownPathName</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">includeSuiteSetup</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">WikiPage</span> <span class="n">suiteTeardown</span> <span class="o">=</span>
                    <span class="n">PageCrawlerImpl</span><span class="o">.</span><span class="na">getInheritedPage</span><span class="o">(</span>
                            <span class="n">SuiteResponder</span><span class="o">.</span><span class="na">SUITE_TEARDOWN_NAME</span><span class="o">,</span>
                            <span class="n">wikiPage</span>
                    <span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">suiteTeardown</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">WikiPagePath</span> <span class="n">pagePath</span> <span class="o">=</span>
                        <span class="n">suiteTeardown</span><span class="o">.</span><span class="na">getPageCrawler</span><span class="o">().</span><span class="na">getFullPath</span><span class="o">(</span><span class="n">suiteTeardown</span><span class="o">);</span>
                <span class="n">String</span> <span class="n">pagePathName</span> <span class="o">=</span> <span class="n">PathParser</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="n">pagePath</span><span class="o">);</span>
                <span class="n">buffer</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;!include -teardown .&quot;</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pagePathName</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;\n&quot;</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">pageData</span><span class="o">.</span><span class="na">setContent</span><span class="o">(</span><span class="n">buffer</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="k">return</span> <span class="n">pageData</span><span class="o">.</span><span class="na">getHtml</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>


<p>Obviously, this is not a well-written function. But what problems does it have?!</p>
<div class="highlight"><pre><span></span>- Too much going on, i.e. too big
- Many different levels of abstraction
- Nested if statements controlled by flags
</pre></div>


<p>With little method extraction, renaming and restructuring, we can come to the better version:</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">renderPageWithSetupsAndTeardowns</span><span class="o">(</span><span class="n">PageData</span> <span class="n">pageData</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSuite</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="kt">boolean</span> <span class="n">isTestPage</span> <span class="o">=</span> <span class="n">pageData</span><span class="o">.</span><span class="na">hasAttribute</span><span class="o">(</span><span class="s">&quot;Test&quot;</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">isTestPage</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">WikiPage</span> <span class="n">testPage</span> <span class="o">=</span> <span class="n">pageData</span><span class="o">.</span><span class="na">getWikiPage</span><span class="o">();</span>
        <span class="n">StringBuffer</span> <span class="n">newPageContent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuffer</span><span class="o">();</span>
        <span class="n">includeSetupPages</span><span class="o">(</span><span class="n">testPage</span><span class="o">,</span> <span class="n">newPageContent</span><span class="o">,</span> <span class="n">isSuite</span><span class="o">);</span>
        <span class="n">newPageContent</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">pageData</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
        <span class="n">includeTeardownPages</span><span class="o">(</span><span class="n">testPage</span><span class="o">,</span> <span class="n">newPageContent</span><span class="o">,</span> <span class="n">isSuite</span><span class="o">);</span>
        <span class="n">pageData</span><span class="o">.</span><span class="na">setContent</span><span class="o">(</span><span class="n">newPageContent</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">pageData</span><span class="o">.</span><span class="na">getHtml</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>


<p>Now, it is much better! But the main question remains: What attributes should we give our functions that 
will a casual reader to intuit what it does easily?</p>
<h2>Small</h2>
<p>Functions should be small! They should even be smaller than that! Actually, the code above is too large and
it should be shortened to this:</p>
<div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">renderPageWithSetupsAndTeardowns</span><span class="o">(</span><span class="n">PageData</span> <span class="n">pageData</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isSuite</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">isTestPage</span><span class="o">(</span><span class="n">pageData</span><span class="o">))</span>
        <span class="n">includeSetupAndTeardownPages</span><span class="o">(</span><span class="n">pageData</span><span class="o">,</span> <span class="n">isSuite</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">pageData</span><span class="o">.</span><span class="na">getHtml</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>


<p>How long? Uncle Bob says that they should hardly be 20 lines long.</p>
<h2>Do One Thing</h2>
<p>Functions should do one thing. They should do it well. They should do it only.</p>
<p>The function <code>testableHtml()</code> is doing too many things:</p>
<div class="highlight"><pre><span></span>- Creating buffers
- Fetching pages
- Searching for inherited pages
- Rendering paths
- Generating HTML
</pre></div>


<p>On the other hand, the function <code>renderPageWithSetupsAndTeardowns()</code> is doing only one thing: Including setups and teardowns into test pages!</p>
<p>However, it can be hard to know what that one thing is. Hence, the next rule.</p>
<h2>One level of abstraction per function</h2>
<p>Let's see the following example to understand what one level of abstraction means.
Imagine we need to write a function that builds a house. That is, our function should answer the question of
"What needs to be done to build a house?". The answer would roughly be: find location, design, get permits, break ground and etc...
In code, it would look something like this: </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">buildHouse</span><span class="p">():</span>
    <span class="n">find_location</span><span class="p">()</span>
    <span class="n">design</span><span class="p">()</span>
    <span class="n">fix_documents</span><span class="p">()</span>
    <span class="n">break_ground</span><span class="p">()</span>
    <span class="n">build_walls_and_roof</span><span class="p">()</span>
    <span class="n">etc</span><span class="o">...</span><span class="p">()</span>
</pre></div>


<p>This function does have only one level of abstraction. Everything inside the function is a part of the answer to the question of "how to build a house?".
To compare, take a look at the following:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">buildHouse</span><span class="p">():</span>
    <span class="n">select_desirable_place</span><span class="p">()</span>
    <span class="n">select_property</span><span class="p">()</span>
    <span class="n">survey_property</span><span class="p">()</span>
    <span class="n">consider_access_issues</span><span class="p">()</span>

    <span class="n">consult_architect</span><span class="p">()</span>
    <span class="n">design_utilities</span><span class="p">()</span>
    <span class="n">design_efficiently</span><span class="p">()</span>

    <span class="n">etc</span><span class="o">...</span><span class="p">()</span>
</pre></div>


<p>Do you see it? The first 4 functions is not a part of the answer to the question: "What to do to build a house?", but rather "What to do to find a location to build a house?".
Do you see it now? They are 2 levels deep, not one! In real code, it would look much worse.</p>
<h2>Use descriptive names</h2>
<p>The title says it all. Examples: is_testable(), includePages().
You know you are working on clean code when each function turns out to be pretty much what you expected.</p>
<p>In choosing a name, we should:
    - not be afraid to make a long name
    - not be afraid to spend time choosing a name
    - even try several different names and read the code with each in place
    - be consistent in our names</p>
<p>Follow these pieces of advice and your functions become much cleaner and more maintainable.</p>
<p>Fight on!</p>
  </div>

<div class="end">
    <span>
        If you liked what you read, I would really appreciate if you could endorse me on
        <a href="https://www.linkedin.com/in/jahongirrahmonov/">LinkedIn</a>

        <button id="subscribe">Subscribe</button>
    </span>

    <!-- Begin MailChimp Signup Form -->

<!--End mc_embed_signup-->
</div>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES * * */
        var disqus_shortname = 'jrahmonov';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-67392250-1', 'auto');
      ga('send', 'pageview');
    </script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/static/js/mobile.js"></script>
    <script src="/static/vendor/lightbox2/js/lightbox.min.js"></script>

</body>
</html>