<!DOCTYPE html>
<html lang="en">
<head prefix="og: http://ogp.me/ns#">
          <title> Run a Django app with Gunicorn in Ubuntu 16.04 (Part I) - Jahongir Rahmonov </title>

        <link rel="stylesheet" href="/static/css/main.css" />
        <link rel="stylesheet" href="/static/css/pygment.css" />
        <link rel="stylesheet" href="/static/css/font-awesome.min.css" />
        <link href="//fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="/static/vendor/lightbox2/css/lightbox.min.css">

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Jahongir Rahmonov's personal blog" />
        <meta name="author" content="Jahongir Rahmonov" />
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<meta property="og:title" content="Run a Django app with Gunicorn in Ubuntu 16.04 (Part I) - Jahongir Rahmonov">
<meta property="og:type" content="website">
<meta property="og:image" content="/static/images/programming.jpg">
<meta property="og:url" content="http://rahmonov.github.io/posts/run-a-django-app-with-gunicorn-in-ubuntu-16-04/">
<meta property="og:description" content="<p>How to run a Django app with Gunicorn instead of a development server</p>">

        <link href="http://rahmonov.github.io/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Jahongir Rahmonov Full Atom Feed" />
        <link href="http://rahmonov.github.io/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Jahongir Rahmonov Full RSS Feed" />
        <link href="http://rahmonov.github.io/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="Jahongir Rahmonov Categories Atom Feed" />



    <meta name="tags" content="python" />
    <meta name="tags" content="django" />
    <meta name="tags" content="gunicorn" />

</head>

<body id="index" class="home">
    <div class="container">

        <button class="nav js-mobile">
            <i class="fa fa-bars"></i>
        </button>

        <div class="side">
            <div class="logo">
                <a href="/"><img src="/static/images/me.jpg" class="jahon" alt="Jahongir Rahmonov"/></a>
            </div>

            <h2>Jahongir Rahmonov</h2>

            <div class="paragraphs">
<p>
    I'm a Software Developer at <a href="http://mysuperdispatch.com/">Super Dispatch (TechStars '16)</a>.
    Avid reader.
    <a href="http://wiut.uz/">WIUT</a> graduate.
    Blogger and an amateur speaker
</p>
<p>
    I write about Python, Django, AngularJS and sometimes something non-technical.
</p>
<p>
    Welcome to my corner :-)
</p>            </div>

            <form method="get" action="https://www.google.com/search">
                <input name="sitesearch" value="rahmonov.me" type="hidden">
                <input type="text" id="search-query" class="field field-text" required="required" name="q" placeholder="Search..." autocomplete="off">
                <input type="image" src="/static/images/search-icon.png" width="20" height="20" class="search-icon" title="Search via Google" alt="Search via Google">
            </form>

            <ul class="menu">
                <li><a href="/">Home</a></li>
                <li><a href="/pages/posts.html">Posts</a></li>
                <li><a href="/pages/about.html">About</a></li>
                <li><a href="/pages/about.html#contact">Contact</a></li>
                <li><a href="/feeds/atom.xml" target="_blank">RSS <i class="fa fa-rss"></i></a></li>
            </ul>

            <p class="profiles">
                <a title="GitHub" href="https://github.com/rahmonov" target="_blank"><i class="fa fa-github-square"></i></a>
                <a title="Twitter" href="https://twitter.com/the_rahmonov" target="_blank"><i class="fa fa-twitter-square"></i></a>
                <a title="Facebook" href="https://www.facebook.com/rahmonovj" target="_blank"><i class="fa fa-facebook-official"></i></a>
                <a title="Bitbucket" href="https://bitbucket.org/Jahongir/" target="_blank"><i class="fa fa-bitbucket-square"></i></a>
                <a title="LinkedIn" href="https://www.linkedin.com/in/jahongirrahmonov" target="_blank"><i class="fa fa-linkedin-square"></i></a>
            </p>
        </div>

        <div class="wrap">
            <div class="content">

  <h4>Tue 21 February 2017</h4>

  <h1>Run a Django app with Gunicorn in Ubuntu 16.04 (Part I)</h1>

  <div class="entry-content">
    <p>This tutorial is aimed at beginners and is a part of a series where we learn to run a django app with Gunicorn and Nginx, and manage
it with the help of the Supervisord. Basically, we are trying to emulate a production environment.</p>
<h2>The Problem</h2>
<p>We are all very well aware that we can run our django app simply by executing a <code>./manage.py runserver</code> command. We also know that it is
called a <em>development</em> server for a reason. You know it is not robust, security issues, thread issues and etc. So, how do we <em>really</em> run
our app then?</p>
<h2>The Solution</h2>
<p>Enter <a href="http://gunicorn.org/">Gunicorn</a>, a simple, light and speedy Python WSGI HTTP Server for UNIX. We will see how to use gunicorn now 
but it is not the main reason I wrote this tutorial. The main reason is this: back in the day I was terrified at the thought of anything
related to <em>production vs development</em> stuff because I thought, you know, <strong>THESE ARE NGINX and GUNICORN</strong> which can support millions of
requests per second and are very secure/robust/reliable and thus should be very difficult to learn and configure. I want to prevent others
from experiencing the same and demonstrate that it is really <strong>simple</strong> and <strong>simple</strong>.</p>
<p>Enough talk, let's fight! (YAY, always wanted to quote Kung Fu Panda)</p>
<h2>Installation</h2>
<p>First, let's go ahead and update/upgrade our packages:</p>
<div class="highlight"><pre><span></span>sudo apt-get update
sudo apt-get upgrade
</pre></div>


<p>Now, install <code>pip</code>.
If you are using python2, type the following:</p>
<div class="highlight"><pre><span></span>sudo apt-get install python-pip
</pre></div>


<p>If you are instead using python3, type the following:</p>
<div class="highlight"><pre><span></span>sudo apt-get install python3-pip
</pre></div>


<p>Now install <code>virtualenv</code>:
For python2:</p>
<div class="highlight"><pre><span></span>sudo pip install virtualenv
</pre></div>


<p>For python3:</p>
<div class="highlight"><pre><span></span>sudo pip3 install virtualenv
</pre></div>


<p>Let's go ahead now and install a virtual environment at <code>/opt/envs/myprojenv</code>. You can install it anywhere you like and in real life use 
a more descriptive name for the virtualenv:</p>
<div class="highlight"><pre><span></span>virtualenv /opt/envs/myprojenv
</pre></div>


<p>Activate it:</p>
<div class="highlight"><pre><span></span><span class="nb">source</span> /opt/envs/myprojenv/bin/activate
</pre></div>


<p>You should now see <code>(myprojenv)</code> at the beginning of your command line.</p>
<p>Now, install Django. By the way, we will only use <code>pip</code> from now on, not <code>pip3</code>, as we are inside a virtual environment:</p>
<div class="highlight"><pre><span></span>pip install django
</pre></div>


<p>Create a project:</p>
<div class="highlight"><pre><span></span>django-admin startproject myproject
</pre></div>


<p>Apply migrations and run the development server:</p>
<div class="highlight"><pre><span></span><span class="nb">cd</span> myproject
./manage.py migrate
./manage.py runserver
</pre></div>


<p>Go to <code>localhost:8000/admin</code> and make sure that it is running. Is it running? Cool! Easy right?!
Now we will replace this development server with gunicorn and you will see that it is <strong>as easy</strong>.</p>
<p>Install gunicorn:</p>
<div class="highlight"><pre><span></span>pip install gunicorn
</pre></div>


<p>Run this, go to <code>localhost:8000</code>and behold the magic:</p>
<div class="highlight"><pre><span></span>gunicorn myproject.wsgi
</pre></div>


<p>DO YOU SEE IT? It is this easy.</p>
<p>Now you might be wondering what is that <code>wsgi</code> thing is. Well, it stands for Web Server Gateway Interface and basically is a way how
apps/frameworks and servers talk to each other. If the server(like Gunicorn) has <code>wsgi</code> implemented and so has your framework(Django),
it means that you can run your app with that server. And the entry point of communication for these two is the variable <code>application</code>,
which is located in <code>myproject/wsgi.py</code> in our case. You can read more about this in <a href="https://www.python.org/dev/peps/pep-0333/">PEP 333</a>. </p>
<p>Let's play with it a little bit to see what it got.</p>
<p>We can bind it to a specific port:</p>
<div class="highlight"><pre><span></span>gunicorn --bind 0.0.0.0:8030 myproject.wsgi
</pre></div>


<p>You can increase the number of workers to serve requests, which you probable will in real life as your users increase:</p>
<div class="highlight"><pre><span></span>gunicorn --workers <span class="m">3</span> myproject.wsgi
</pre></div>


<p>Run it in a daemon mode:</p>
<div class="highlight"><pre><span></span>gunicorn --daemon myproject.wsgi
</pre></div>


<p>Or all of them altogether(a shorter version):</p>
<div class="highlight"><pre><span></span>gunicorn -d -b 0.0.0.0:8030 -w <span class="m">3</span> myproject.wsgi
</pre></div>


<p>Read more about these options <a href="http://docs.gunicorn.org/en/stable/run.html#commonly-used-arguments">in the docs</a></p>
<p>If these options get too long, you can create an <code>ini</code> file and run it like this:</p>
<div class="highlight"><pre><span></span>gunicorn -c /path/to/config/file myproject.wsgi
</pre></div>


<p>After running your app with gunicorn, go to the django admin panel at <code>localhost:8000/admin</code>. You will see that all styles are gone.
The reason is that gunicorn is an application server and it does not serve static files. In order to solve this problem, we will take a look
at <code>Nginx</code> next and use it as a reverse proxy for gunicorn. We will talk about what <code>reverse proxy</code> is as well so don't think about it for now.</p>
<p>Well, that's it for now. This is a brief overview of django with gunicorn. Go to <a href="http://docs.gunicorn.org/en/stable/">docs</a> and read more.</p>
<p>Fight on!</p>
<p><a href="http://rahmonov.me/posts/run-a-django-app-with-nginx-and-gunicorn/">Part II</a></p>
<p><a href="http://rahmonov.me/posts/run-a-django-app-with-nginx-gunicorn-and-supervisor/">Part III</a></p>
  </div>

<div class="end">
    <span>
        If you liked what you read, I would really appreciate if you could endorse me on
        <a href="https://www.linkedin.com/in/jahongirrahmonov/">LinkedIn</a>
    </span>

    <!-- Begin MailChimp Signup Form -->

<!--End mc_embed_signup-->
</div>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES * * */
        var disqus_shortname = 'jrahmonov';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
            </div>
        </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-67392250-1', 'auto');
      ga('send', 'pageview');
    </script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="/static/js/mobile.js"></script>
    <script src="/static/vendor/lightbox2/js/lightbox.min.js"></script>

</body>
</html>