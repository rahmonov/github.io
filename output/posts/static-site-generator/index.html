<!DOCTYPE html><html lang="en"><head prefix="og: http://ogp.me/ns#"><title>Static Site Generator in Python</title><link rel="stylesheet" href="/static/css/main.css"><link rel="stylesheet" href="/static/css/pygment.css"><link rel="stylesheet" href="/static/css/font-awesome.min.css"><link href="//fonts.googleapis.com/css?family=Droid+Sans:400,700" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/vendor/lightbox2/css/lightbox.min.css"><link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet"><link rel="shortcut icon" type="image/png" href="/static/images/favicon.png"><meta name="google-site-verification" content="RhKly6bfyZ4vo03CPdY9f-Bg8CuZA0GhTPvCEPsNa2c"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="<p>What are static site generators? How to write your own in Python?</p>"><meta name="author" content="Jahongir Rahmonov"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta property="og:title" content="Static Site Generator in Python"><meta property="og:type" content="website"><meta property="og:image" content="/static/images/programming.jpg"><meta property="og:url" content="http://rahmonov.me/posts/static-site-generator/"><meta property="og:description" content="<p>What are static site generators? How to write your own in Python?</p>"><link href="http://rahmonov.me/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Jahongir Rahmonov Full Atom Feed"><link href="http://rahmonov.me/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Jahongir Rahmonov Full RSS Feed"><link href="http://rahmonov.me/feeds/python.atom.xml" type="application/atom+xml" rel="alternate" title="Jahongir Rahmonov Categories Atom Feed"><meta name="description" content="<p>What are static site generators? How to write your own in Python?</p>"><meta name="tags" content="programming"><meta name="tags" content="python"><link href="https://unpkg.com/ilyabirman-likely@2/release/likely.css" rel="stylesheet"><script src="https://unpkg.com/ilyabirman-likely@2/release/likely.js" type="text/javascript"></script></head><body id="index" class="home"><div class="container"><button class="nav js-mobile"><i class="fa fa-bars"></i></button><div class="side"><div class="logo"><a href="/"><img src="/static/images/me.jpg" width="150" height="150" class="jahon" alt="Jahongir Rahmonov"></a></div><h2>Jahongir Rahmonov</h2><div class="paragraphs"><p> I'm a Software Developer at <a href="http://mysuperdispatch.com/">Super Dispatch (TechStars '16)</a>. Avid reader. <a href="http://wiut.uz/">WIUT</a> graduate. Blogger and an amateur speaker </p><p> I write about Python, Django, AngularJS and sometimes something non-technical. </p><p> Welcome to my corner <i class="em em-snake"></i></p> </div><form method="get" action="https://www.google.com/search"><input name="sitesearch" value="rahmonov.me" type="hidden"><input type="text" id="search-query" class="field field-text" required name="q" placeholder="Search..." autocomplete="off"><input type="image" src="/static/images/search-icon.png" width="20" height="20" class="search-icon" title="Search via Google" alt="Search via Google"></form><ul class="menu"><li><a href="/">Home</a></li><li><a href="/pages/about.html">About</a></li><li><a href="/pages/about.html#subscribe">Subscribe</a></li><li><a href="/pages/about.html#contact">Contact</a></li><li><a href="/feeds/atom.xml">RSS <i class="fa fa-rss"></i></a></li></ul><p class="profiles"><a title="GitHub" href="https://github.com/rahmonov"><i class="fa fa-github-square"></i></a><a title="StackOverflow" href="https://stackoverflow.com/users/4137194/jahongir-rahmonov?tab=profile"><i class="fa fa-stack-overflow"></i></a><a title="Twitter" href="https://twitter.com/the_rahmonov"><i class="fa fa-twitter-square"></i></a><a title="Facebook" href="https://www.facebook.com/rahmonovj"><i class="fa fa-facebook-official"></i></a><a title="Instagram" href="https://www.instagram.com/rahmonov.me/"><i class="fa fa-instagram"></i></a><a title="LinkedIn" href="https://www.linkedin.com/in/jahongirrahmonov"><i class="fa fa-linkedin-square"></i></a></p></div><div class="wrap"><div class="content"><h4>Sat 31 March 2018</h4><h1>Static Site Generator in Python</h1><div class="entry-content"><p>Static site generators are all the rage lately. This very website that you are reading is also powered by a static site generator and I love it. But why have they become so popular? What advantages do they have in comparison to some content management system such as Wordpress?</p><p>First of all, Wordpress uses server-side code. It means that each time a user enters a website, Wordpress fetches the content from the database and re-creates the pages for you. That is, content is created only after you request it. With static site generators, you pre-create everything and serve the ready content to all users. This is much faster than dynamically recreating the content each time.</p><p>Second of all, you need to host your CMS somewhere and take care of your infrastructure. Although, it is pretty cheap now, it is still a headache. With static site generators, you have GitHub Pages which takes care of everything for you absolutely for free. It is extremely easy as well.</p><p>Additionally, as CMSs rely on a programming language and a database, it is by definition less secure than a static web site.</p><h2>How it works</h2><p>The way static site generators work is pretty simple. You write your blog posts in a markdown file and when you run your static site generator, it will compile your posts into pre-created templates which then can be served to your readers.</p><p>For example, let's say that you have a markdown file <code>introduction-to-kubernetes.md</code> in which you have your post content:</p><div class="highlight"><pre><span></span>title: Introduction to Kubernetes
date: 2018-02-03 20:10

Looking back, <span class="m">2017</span> was the year Kubernetes conquered the container orchestration space. For years, Kubernetes<span class="s1">&#39; rivals</span>
<span class="s1">such as Docker Swarm and Mesos have been offering their own container orchestration tools and now they both added</span>
<span class="s1">support for Kubernetes within their ecosystems. The largest cloud providers such as AWS, Microsoft Azure and Oracle</span>
<span class="s1">Cloud announced Kubernetes integrations into their respective cloud platforms, not mentioning Google where Kubernetes</span>
<span class="s1">came from originally. So, every developer would benefit from at least learning the basics of Kubernetes. That&#39;</span>s exactly
what we are going to <span class="k">do</span> in this post.
</pre></div><p>Also, you have this template:</p><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{ title }}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Published at: {{ date }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
{{ content }}
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div><p>And when you run your static site generator, you will have something like this as a result:</p><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Introduction to Kubernetes<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Published at: 2018-02-03 20:10<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
Looking back, 2017 was the year Kubernetes conquered the container orchestration space. For years, Kubernetes&#39; rivals
such as Docker Swarm and Mesos have been offering their own container orchestration tools and now they both added
support for Kubernetes within their ecosystems. The largest cloud providers such as AWS, Microsoft Azure and Oracle
Cloud announced Kubernetes integrations into their respective cloud platforms, not mentioning Google where Kubernetes
came from originally. So, every developer would benefit from at least learning the basics of Kubernetes. That&#39;s exactly
what we are going to do in this post.
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div><p>What happened is that your generator parsed the markdown and put the details in your template where they belong. Easy!</p><p>The next step is you deploy these ready files and your readers will enjoy your fast and secure content. And after a year or so you become famous and be buried with thousands of offers for a job or partnership.</p><p>Such a simple but at the same time very powerful idea.</p><p>Seems like a pretty good idea for a weekend project, doesn't it? Why don't we try to create our own version of a static site generator, you and I? What do you say? A very basic one. Agree? Cool! Let's get started.</p><h2>Let's reinvent static site generators</h2><p>Here is the plan. We will do two pages. On the first main page, we are going to show the list of all posts, sorted by date, with their titles, published date and their summary, which will look something like this:</p><div class="gallery medium"><a href="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/index.png" rel="lightbox" title="Index page"><img src="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/index.png" alt="Index page"><span>Index Page</span></a></div><p>Then, if the user clicks on the title of any post, he is taken to its detail page where he can read the whole content:</p><div class="gallery medium"><a href="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/post-page.png" rel="lightbox" title="Detail page"><img src="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/post-page.png" alt="Detail page"><span>Detail Page</span></a></div><p>Okay? Let's create our project folder then:</p><div class="highlight"><pre><span></span>mkdir custom-ssg
</pre></div><p><code>ssg</code> stands for Static Site Generator, by the way.</p><p>In this folder, create the <code>content</code> folder where we will write our markdown files, that is, our blog posts:</p><div class="highlight"><pre><span></span><span class="nb">cd</span> custom-ssg <span class="p">&amp;</span> mkdir content
</pre></div><p>In the <code>content</code> folder, create your first blog post file <code>how-to-become-senior.md</code> and copy the contents of <a href="https://gist.githubusercontent.com/rahmonov/e5a334184237c48dc3fdb198fcf82abf/raw/2fe4039857fac4bc3b39de238acf8fa97aedd827/how-to-become-senior.md">this file</a>.</p><p>In the project root, create <code>ssg.py</code> which will be our main file where we will write our script to generate static pages.</p><p>Now, we need a way to turn markdown files such as the one we created that looks like this:</p><div class="highlight"><pre><span></span>title: How to become a senior software developer?
date: 2019-03-10 20:10
slug: how-to-become-senior-software-developer
summary: You have been a junior or a middle developer <span class="k">for</span> too long now. You feel like you deserve more. You feel like it is <span class="nb">time</span> to grab life by the balls and rise up the career ladder.

You have been a junior or a middle developer <span class="k">for</span> too long now. You feel like you deserve more. You feel like it is <span class="nb">time</span>
to grab life by the balls and rise up the career ladder. Well, congratulations! You are so lucky to be reading this blog post
because I am about to reveal a secret ingredient I used to become a senior software developer. This is a unique ingredient
which no one <span class="k">else</span> is aware of and which will skyrocket your career in no time. But I warn you! This is not an easy feat
to accomplish. Ready? Let<span class="err">&#39;</span>s go.
...
</pre></div><p>into something like this:</p><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;2019-03-10 20:10&#39;</span><span class="p">,</span>
    <span class="s1">&#39;slug&#39;</span><span class="p">:</span> <span class="s1">&#39;how-to-become-senior-software-developer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;You have been a junior or a middle developer for too long now. You feel like you deserve more. You feel like it is time to grab life by the balls and rise up the career ladder.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;How to become a senior software developer?&#39;</span>
    <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;p&gt;You have been a junior or a middle developer for too long now. You feel like you deserve more.&lt;/p&gt;...&#39;</span>
 <span class="p">}</span>
</pre></div><p>Fortunately, the coolest Python community has already done the work for us and written <a href="https://github.com/trentm/python-markdown2">this awesome library</a>. Before we install it, please note that the best practice is to use <a href="https://virtualenv.pypa.io/en/stable/">a virtualenv</a> for packages. Let's install the package:</p><div class="highlight"><pre><span></span>pip install markdown2
</pre></div><p>Now, let's try this out in our <code>ssg.py</code>:</p><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">markdown2</span> <span class="kn">import</span> <span class="n">markdown</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;content/how-to-become-senior.md&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">parsed_md</span> <span class="o">=</span> <span class="n">markdown</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">extras</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">])</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Metadata: &#39;</span><span class="p">,</span> <span class="n">parsed_md</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Content: &#39;</span><span class="p">,</span> <span class="n">parsed_md</span><span class="p">)</span>
</pre></div><p>The output should be the following:</p><div class="highlight"><pre><span></span>Metadata: <span class="o">{</span><span class="s1">&#39;title&#39;</span>: <span class="s1">&#39;How to become a senior software developer?&#39;</span>, <span class="s1">&#39;date&#39;</span>: <span class="s1">&#39;2019-03-10 20:10&#39;</span>, <span class="s1">&#39;slug&#39;</span>: <span class="s1">&#39;how-to-become-senior-software-developer&#39;</span>, <span class="s1">&#39;summary&#39;</span>: <span class="s1">&#39;You have been a junior or a middle developer for too long now. You feel like you deserve more. You feel like it is time to grab life by the balls and rise up the career ladder.&#39;</span><span class="o">}</span>

Content: &lt;p&gt;You have been a junior or a middle developer <span class="k">for</span> too long now. You feel like you deserve more. You feel like it is time...
</pre></div><p>Great. Exactly what we needed! Now we can use these variables to create pages. But before that we need templates and not just ordinary html files but ones with placeholders for our variables.</p><p>For example, this:</p><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>{{post.title}}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{post.title}}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>{{post.date}}<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;</span>

{{post.content}}

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div><p>If we had this template file, we could use the variables we generated above and insert them into this template. Fortunately, that's easy too thanks to <a href="http://jinja.pocoo.org/docs/2.10/">Jinja2</a>, a modern templating language for Python. Install it:</p><div class="highlight"><pre><span></span>pip install jinja2
</pre></div><p>To try Jinja2 out, create a folder <code>templates</code> in the project root and create a <code>post-detail.html</code> and put the above html inside this file.</p><p>Now, in your <code>ssg.py</code>, append the following code:</p><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">PackageLoader</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">PackageLoader</span><span class="p">(</span><span class="s1">&#39;custom-ssg&#39;</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">))</span>
<span class="n">post_detail_template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;post-detail.html&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">parsed_md</span><span class="p">,</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">parsed_md</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">parsed_md</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">print</span><span class="p">(</span><span class="n">post_detail_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="n">data</span><span class="p">))</span>
</pre></div><p>After this, your <code>ssg.py</code> should look like this:</p><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">PackageLoader</span>
<span class="kn">from</span> <span class="nn">markdown2</span> <span class="kn">import</span> <span class="n">markdown</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;content/how-to-become-senior.md&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="n">parsed_md</span> <span class="o">=</span> <span class="n">markdown</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">extras</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">])</span>

    <span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">PackageLoader</span><span class="p">(</span><span class="s1">&#39;ssg&#39;</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">))</span>
    <span class="n">post_detail_template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;post-detail.html&#39;</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">parsed_md</span><span class="p">,</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">parsed_md</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
        <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">parsed_md</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="k">print</span><span class="p">(</span><span class="n">post_detail_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="n">data</span><span class="p">))</span>
</pre></div><p>As you can see here, the first thing we need to do is to create an <code>Environment</code> by showing where the templates folder is located. Then, with this environment we get the template we need and at the end we call <code>render()</code> function and pass it the data it needs.</p><p>If you run your <code>ssg.py</code>, you will see that the code parsed the markdown and put all the data in its own place in the above template. Great!</p><p>But before we can reinvent static site generators, we should create the <code>index.html</code> where we show the list of all posts. So, create <code>index.html</code> inside the templates folder and put the following in this file:</p><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>List of Posts<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>My Blog Posts<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

{% for post in posts %}
  <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>{{loop.index}}: <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;posts/{{ post.slug }}/&quot;</span><span class="p">&gt;</span>{{post.title}}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span>{{post.date}}<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
      {{post.summary}}
  <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
{% endfor %}

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div><p>We are simply looping through the <code>posts</code> list and showing all the data except the main content.</p><p>We have all the pieces now and we can get started with building our static site generator.</p><p>We will do it in several steps. First, delete the contents of <code>ssg.py</code>. We will write the real code now.</p><p>Now, let's import all the packages that we will need along the way:</p><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">PackageLoader</span>
<span class="kn">from</span> <span class="nn">markdown2</span> <span class="kn">import</span> <span class="n">markdown</span>
</pre></div><p>What we will do next is parse all markdown files and collect them in a dictionary so that we can use them later:</p><div class="highlight"><pre><span></span><span class="n">POSTS</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">markdown_post</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">):</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="n">markdown_post</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="n">POSTS</span><span class="p">[</span><span class="n">markdown_post</span><span class="p">]</span> <span class="o">=</span> <span class="n">markdown</span><span class="p">(</span><span class="nb">file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">extras</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">])</span>
</pre></div><p>Fairly easy. Next we sort these posts by their published date in a reversed order so that we show the newest ones first:</p><div class="highlight"><pre><span></span><span class="n">POSTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">post</span><span class="p">:</span> <span class="n">POSTS</span><span class="p">[</span><span class="n">post</span><span class="p">]</span> <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">POSTS</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">post</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">POSTS</span><span class="p">[</span><span class="n">post</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">  %H:%M&#39;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="p">}</span>
</pre></div><p>One thing to note here is we need to convert the date to <code>datetime</code> first in order to properly sort the posts as comparing strings would not work correctly.</p><p>Next, we get the html template files with Jinja2:</p><div class="highlight"><pre><span></span><span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">PackageLoader</span><span class="p">(</span><span class="s1">&#39;ssg&#39;</span><span class="p">,</span> <span class="s1">&#39;templates&#39;</span><span class="p">))</span>
<span class="n">index_template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
<span class="n">post_template</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;post-detail.html&#39;</span><span class="p">)</span>
</pre></div><p>Now, we can render the <code>index.html</code> by passing the data it needs:</p><div class="highlight"><pre><span></span><span class="n">index_posts_metadata</span> <span class="o">=</span> <span class="p">[</span><span class="n">POSTS</span><span class="p">[</span><span class="n">post</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span> <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">POSTS</span><span class="p">]</span>

<span class="n">index_html_content</span> <span class="o">=</span> <span class="n">index_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">posts</span><span class="o">=</span><span class="n">index_posts_metadata</span><span class="p">)</span>
</pre></div><p>Now we can create write the contents of <code>index_html_content</code> into a real file inside the <code>output</code> folder that we can serve to our users:</p><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output/index.html&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
    <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">index_html_content</span><span class="p">)</span>
</pre></div><p>We don't have the <code>output</code> folder yet, so create it:</p><div class="highlight"><pre><span></span>mkdir output
</pre></div><p>If you run your <code>ssg.py</code> at this point, you will have <code>index.html</code> inside your <code>output</code> folder and if you open it in the browser, it will look like this:</p><div class="gallery medium"><a href="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/index-1.png" rel="lightbox" title="Index Page"><img src="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/index-1.png" alt="Index Page"><span>Index Page with one post</span></a></div><p>Try adding these <a href="https://gist.githubusercontent.com/rahmonov/d7ea448d377c82096a16638dd1448343/raw/61e1cd710b87a84cbe16573bea5e48a376997a97/top-books-i-read.md">top-books-i-read.md</a> and <a href="https://gist.githubusercontent.com/rahmonov/ff63781e9d783f5b6d0b866a21df2db6/raw/365bd7e899f4d2968aba5024cd3ada271f3cbb49/nginx-ingress.md">nginx-ingress.md</a> into your <code>content</code> folder and then run <code>ssg.py</code> again.</p><p>You will now see that your <code>index.html</code> has three posts listed:</p><div class="gallery medium"><a href="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/index-3.png" rel="lightbox" title="Index Page"><img src="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/index-3.png" alt="Index Page"><span>Index Page with three posts</span></a></div><p>However, if you click on the title, there will be a not found error as we haven't generated the detail pages yet.</p><p>It is also not difficult to do. Append the following code to <code>ssg.py</code>:</p><div class="highlight"><pre><span></span><span class="c1"># render each post and write it to output/posts/&lt;post.slug&gt;/index.html</span>
<span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">POSTS</span><span class="p">:</span>
    <span class="n">post_metadata</span> <span class="o">=</span> <span class="n">POSTS</span><span class="p">[</span><span class="n">post</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span>

    <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="n">POSTS</span><span class="p">[</span><span class="n">post</span><span class="p">],</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="n">post_metadata</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span>
        <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">post_metadata</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="n">post_html_content</span> <span class="o">=</span> <span class="n">post_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">post</span><span class="o">=</span><span class="n">post_data</span><span class="p">)</span>

    <span class="n">post_file_path</span> <span class="o">=</span> <span class="s1">&#39;output/posts/{slug}/index.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slug</span><span class="o">=</span><span class="n">post_metadata</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">])</span>

    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">post_file_path</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">post_file_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">post_html_content</span><span class="p">)</span>
</pre></div><p>As you can see, we loop through the posts, get the needed data, render the template by passing it the data and then create a file out of this rendered data in an appropriate folder.</p><p>Now run your <code>ssg.py</code> and then click on the title of a post. You will now see the whole content of the post you clicked:</p><div class="gallery medium"><a href="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/detail-page.png" rel="lightbox" title="Detail Page"><img src="https://s3.amazonaws.com/rahmonov.me/post-images/static-site-generator/detail-page.png" alt="Detail Page"><span>Detail Page</span></a></div><p>Congratulations, you have just built your own static site generator. Cool, right? If you want to challenge yourself, go ahead and add other features such as tagging, pagination and deploy your blog in <a href="https://pages.github.com/">Github Pages</a>.</p><p>If something is not clear, let me know in the comments. I may have made some mental shortcuts along the way :)</p><p>Fight on!</p></div><div class="pagination clearfix"><a class="prev" href="/posts/the-best-books-that-i-have-read/">« Previous</a><a class="next" href="/posts/branch-by-abstraction/">Next »</a></ul></div><p><div class="likely likely-big"><div class="facebook">Share</div><div class="twitter" data-via="rahmon0v">Tweet</div><div class="telegram">Send</div><div class="linkedin">Share</div></div></p><div class="end"><span> If you liked what you read, subscribe below. Once in a while, I will send you a list of my new posts. </span><div id="popup"><p><link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css"><style type="text/css">
                #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
                /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
                   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
            </style><div id="mc_embed_signup"><form action="//rahmonov.us16.list-manage.com/subscribe/post?u=9e30bdfdfe0a7bd7cf7e0d50a&id=af3f3c5f76" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll"><div class="indicates-required"><span class="asterisk">*</span> indicates required</div><div class="mc-field-group"><label for="mce-MMERGE1">Name </label><input type="text" value name="MMERGE1" class id="mce-MMERGE1"></div><div class="mc-field-group"><label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label><input type="email" value name="EMAIL" class="required email" id="mce-EMAIL"></div><div id="mce-responses" class="clear"><div class="response" id="mce-error-response" style="display:none"></div><div class="response" id="mce-success-response" style="display:none"></div></div> <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_9e30bdfdfe0a7bd7cf7e0d50a_af3f3c5f76" tabindex="-1" value></div><div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div></div></form></div></p></div></div><div id="disqus_thread"></div><script type="text/javascript">
        /* * * CONFIGURATION VARIABLES * * */
        var disqus_shortname = 'jrahmonov';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div></div><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-67392250-1', 'auto');
      ga('send', 'pageview');
    </script><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script><script src="/static/js/mobile.js"></script><script src="/static/vendor/lightbox2/js/lightbox.min.js"></script><script src="/static/"></script></body></html>